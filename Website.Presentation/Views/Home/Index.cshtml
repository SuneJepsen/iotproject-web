
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/_Layout.cshtml";
}

<h2>Index</h2>

<div id="myDiv"></div>

<script>
    $(document).ready(function () {
        // do your magic here
        console.log("ready!");

        var inferredData = [{ StartDate: "25-04-2018 10:00:00", Count: 2 }, { StartDate: "25-04-2018 10:00:30", Count: -1 }, { StartDate: "25-04-2018 10:01:00", Count: 5 }];

        //$.ajax({
        //    url: "http://webapiaccess20180420013135.azurewebsites.net/api/values", success: function (result) {
        //        console.log(result);
        //        inferredData = result;
        //    }
        //});

        var count = 0;
        var data = [
            {
                x: inferredData.map(x => x.StartDate),
                y: inferredData.map(x => count += x.Count),
                type: 'scatter'
            }
        ];

        Plotly.newPlot('myDiv', data);

        //function rand() {
        //    return Math.random();
        //}

        //var time = new Date();

        //var data = [{
        //    x: [time],
        //    y: [rand],
        //    mode: 'lines',
        //    line: { color: '#80CAF6' }
        //}]

        //var layout = {
        //    xaxis: {
        //        type: 'date',
        //        range: [time,time],
        //        rangeslider: { range: [time, time] },
        //    }
        //};

        //Plotly.plot('myDiv', data, layout);

        //var cnt = 0;
        //var startingTime = time

        //var interval = setInterval(function () {

        //    var time = new Date();

        //    var update = {
        //        x: [[time]],
        //        y: [[rand()]]
        //    }

        //    var olderTime = time.setMinutes(time.getMinutes() - 1);
        //    var futureTime = time.setMinutes(time.getMinutes() + 1);

        //    var minuteView = {
        //        xaxis: {
        //            type: 'date',
        //            range: [olderTime, futureTime],
        //            rangeslider: { range: [startingTime, futureTime] },
        //        }
        //    };

        //    Plotly.relayout('myDiv', minuteView);
        //    Plotly.extendTraces('myDiv', update, [0])

        //    if (cnt === 100) clearInterval(interval);
        //}, 1000);

    });
</script>